<article>
    <h1 id="title">{{title}}</h1>
    <div class="infos secondary">{{info}}</div>
    {{body}}
    <script>
        // For enabling seamless replacement of pages, a "title-at" anchor is
        // supported: "mgar.us/some-article#title-at--10" should adjust the
        // scrolling position so that the title is at position -10 in the
        // viewport.
        var desiredScrollingPosition = 0;
        window.addEventListener('load', (event) => {
            const urlParts = document.URL.split("#");
            if (urlParts == 1) return;
            const anchor = urlParts[1];
            if (!anchor) return;
            if (!anchor.startsWith("title-at-")) return;
            const desiredTitlePosition = parseInt(anchor.substring("title-at-".length));
            if (Number.isNaN(desiredTitlePosition)) return;
            const actualTitlePosition = document.getElementById("title").getBoundingClientRect().top;
            desiredScrollPosition = -(window.scrollY - actualTitlePosition + desiredTitlePosition);
            window.scrollTo(window.scrollX, desiredScrollPosition);
        });
    </script>
</article>

<footer class="secondary" style="margin-top: 2em;">

    <!-- Shortlink -->
    <script>
        const shortlink = "mgar.us/{{key}}";
        async function copyShortlink() {
            await navigator.clipboard.writeText(shortlink);

            let confirmationText = " Copied! ";
            while (confirmationText.length < shortlink.length) {
                confirmationText = confirmationText + "-";
                if (confirmationText.length < shortlink.length) {
                    confirmationText = "-" + confirmationText;
                }
                console.log("Confirmation text is now " + confirmationText.length + " long.");
            }
            document.getElementById("shortlink").innerHTML = confirmationText;
        }
        function resetShortlink() {
            document.getElementById("shortlink").innerHTML = shortlink;
        }
    </script>
    <style>
        #shortlink {
            background-color: transparent;
            color: inherit;
            border: 0.1em solid #f97191;
            border-radius: 0.2em;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
        }
    </style>
    <span>You liked this article? Feel free to share it using this shortlink:</span>
    <button id="shortlink" title="Click to copy the shortlink" onclick="copyShortlink()"
        onmouseout="resetShortlink()">mgar.us/{{key}}</button>

    <!-- Suggested article -->
    <style>
        .suggestion-label {
            margin-left: 0;
            margin-right: 0;
        }
        
        .suggestion {
            font-size: 2em;
            text-decoration: none;
            color: var(--main-fg-color);
        }
        .suggestion:hover {
            text-decoration: underline;
        }
    </style>
    <p class="suggestion-label">Looking for another article? This one might be interesting:</p>
    <a href="/{{suggestion-key}}" class="suggestion">{{suggestion-title}}</a>

</footer>
