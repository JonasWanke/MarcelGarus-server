<article>
    <h1 id="title">{{title}}</h1>
    <div class="infos secondary">{{info}}</div>
    {{body}}
    <script>
        // For enabling seamless replacement of pages, a "title-at" anchor is
        // supported: "mgar.us/some-article#title-at--10" should adjust the
        // scrolling position so that the title is at position -10 in the
        // viewport.
        var desiredScrollingPosition = 0;
        window.addEventListener('load', (event) => {
            const urlParts = document.URL.split("#");
            if (urlParts == 1) return;
            const anchor = urlParts[1];
            if (!anchor) return;
            if (!anchor.startsWith("title-at-")) return;
            const desiredTitlePosition = parseInt(anchor.substring("title-at-".length));
            if (Number.isNaN(desiredTitlePosition)) return;
            const actualTitlePosition = document.getElementById("title").getBoundingClientRect().top;
            desiredScrollPosition = -(window.scrollY - actualTitlePosition + desiredTitlePosition);
            window.scrollTo(window.scrollX, desiredScrollPosition);
        });
    </script>
</article>

<!-- Pagination to previous and next article -->
<style>
    .pagination {
        display: flex;
        margin-top: 2em;

        flex-wrap: wrap;
        justify-content: space-between;
    }
    .pagination-item {
        margin-top: 2em;
        
        text-decoration: none;
        color: white;
    }
    .pagination-item:hover > .pagination-title {
        text-decoration: underline;
    }
    .pagination-previous {
        margin-right: auto;
        text-align: left;
    }
    .pagination-next {
        margin-left: auto;
        text-align: right;
    }
    .pagination-is-valid-false {
        display: none;
    }
    .pagination-label {
        font-family: 'Roboto', sans-serif;
        margin-bottom: 0.8em;
    }
    .pagination-title {
        font-size: 2em;
    }
</style>
<footer class="pagination">
    <a href="{{previous-key}}" class="pagination-is-valid-{{has-previous}} pagination-item pagination-previous secondary">
        <div class="pagination-label">˂ Previous</div>
        <div class="pagination-title">{{previous-title}}</div>
    </a>
    <a href="{{next-key}}" class="pagination-is-valid-{{has-next}} pagination-item pagination-next">
        <div class="pagination-label">Next ˃</div>
        <div class="pagination-title">{{next-title}}</div>
    </a>
</footer>

<!-- Shortlink -->
<script>
    const shortlink = "mgar.us/{{key}}";
    async function copyShortlink() {
        await navigator.clipboard.writeText(shortlink);

        let confirmationText = " Copied! ";
        while (confirmationText.length < shortlink.length) {
            confirmationText = confirmationText + "-";
            if (confirmationText.length < shortlink.length) {
                confirmationText = "-" + confirmationText;
            }
            console.log("Confirmation text is now " + confirmationText.length + " long.");
        }
        document.getElementById("shortlink").innerHTML = confirmationText;
    }
    function resetShortlink() {
        document.getElementById("shortlink").innerHTML = shortlink;
    }
</script>
<style>
    #shortlink {
        background-color: transparent;
        color: inherit;
        border: 0.1em solid #f97191;
        border-radius: 0.2em;
        cursor: pointer;
        font-family: 'JetBrains Mono', monospace;
    }
</style>
<footer class="secondary" style="margin-top: 2em;">
    <span>You liked this article? Feel free to share it using this shortlink:</span>
    <button id="shortlink" title="Click to copy the shortlink" onclick="copyShortlink()" onmouseout="resetShortlink()">mgar.us/{{key}}</button>
</footer>
